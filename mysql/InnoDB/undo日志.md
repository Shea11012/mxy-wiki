聚簇索引除了保存完整的用户数据以外，还会自动添加 trx_id、roll_pointer 的隐藏列。如果用户没有在表中定义主键以及不允许存储NULL值的Unique键，还会自动添加一个名 row_id 的隐藏列。

为了保证事务的原子性，InnoDB引入了undo日志，undo日志记载了回滚一个操作的必要内容

## undo 页面链表
一个事务执行中可能混着执行 INSERT、DELETE、UPDATE 语句，这会产生不同类型的undo日志，但是同一个undo页面只能存储同一种类型的undo日志，所以一个事务的执行过程中可能需要2个undo页面的链表：insert undo链表、update undo链表，且对普通表和临时表的记录改动时所产生的undo日志要分别记录，所以一个事务中最多有4个以undo页面为节点组成的链表。分配策略为：
- 开启事务时，不分配undo页面
- 事务执行时向普通表插入记录或执行更新记录主键的操作之后，就会分配一个普通表的insert undo链表
- 事务执行时删除或更新普通表中的记录，会分配一个update undo链表
- 事务执行时向临时表插入记录或执行更新记录主键的操作，会分配一个临时表的insert undo链表
- 事务执行时删除或更新临时表中的记录，会分配一个临时表的update undo链表


## undo日志在崩溃恢复时的作用
如在服务器崩溃的而恢复的过程中，首先按照redo日志将各个页面的数据恢复到崩溃之前的状态，这样保证了已经提交的事务的持久性。但是那些没有提交的事务写的redo日志可能也已经刷盘，此时为了保证事务的原子性，可以通过undo日志进行回滚。